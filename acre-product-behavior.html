<script>
  /**
   * Behavior that highlights stuff.
   *
   * @polymerBehavior AcreProductBehavior
   */

  AcreProductBehavior = {
    properties: {

      /**
       * Describes the product
       * `shortDesciption`, `originalPrice` and `rating` are optional
       * @type {{name: string, image: string, price: number, shortDesciption: string, originalPrice: number, rating: number}}
       */
      product: {
        type: Object,
        value: function() {
          return {};
        }
      },

      /**
       * The href attribute specifies the link's destination
       */
      imageHref: {
        type: String,
        value: 'javascript:;'
      },

      /**
       * The target attribute specifies where to open the linked document:
       * `_blank|_self|_parent|_top|framename`
       */
      imageTarget: {
        type: String,
        value: '_top'
      },

      /**
       * Sets a sizing option for the image.
       * Valid values are contain (default: full aspect ratio of the image is contained within the element and letterboxed)
       * or cover (image is cropped in order to fully cover the bounds of the element),
       */
      imageSizing: {
        type: String,
        value: 'contain'
      },

      /**
       * The href attribute specifies the link's destination
       */
      nameHref: {
        type: String,
        value: 'javascript:;'
      },

      /**
       * The target attribute specifies where to open the linked document:
       * `_blank|_self|_parent|_top|framename`
       */
      nameTarget: {
        type: String,
        value: '_top'
      },

      /**
       * The button label
       */
      buttonLabel: {
        type: String,
        value: "Adicionar ao pedido"
      },

      /**
       * The href attribute specifies the link's destination
       */
      buttonHref: {
        type: String,
        value: 'javascript:;'
      },

      /**
       * The target attribute specifies where to open the linked document:
       * `_blank|_self|_parent|_top|framename`
       */
      buttonTarget: {
        type: String,
        value: '_top'
      },

      hideButton: {
        type: String,
        value: false
      },

      /**
       * Some label like `free shipping`
       */
      label: {
        type: String,
        value: false
      },

      _rating: {
        type: Array,
        computed: '_ratingOkArray(product.rating)'
      },
      _ratingReverse: {
        type: Array,
        computed: '_ratingZeroArray(product.rating)'
      },

      _priceClass: {
        type: String,
        computed: '_computePriceClass(product.instalments)'
      },
    },

    /**
     * The `acre-product-button-click` event is fired whenever the product button is clicked
     *
     * @event acre-product-button-click
     * @detail {{product: Product}}
     */
    _product_clicked: function() {
      this.fire('acre-product-button-click', {
        product: this.product
      });
    },

    _formatPrice: function(price) {
      if (!price) return price;
      price = parseFloat(price);
      return "R$" + price.toFixed(2);
    },
    _ratingOkArray: function(rating) {
      var arr = [];
      for (var i = 0; i < rating; i++) {
        arr.push(i);
      }
      return arr;
    },
    _ratingZeroArray: function(rating) {
      var arr = [];
      for (var i = 0; i < 5 - rating; i++) {
        arr.push(i);
      }
      return arr;
    },

    _computePriceClass: function(instalments) {
      if (instalments) {
        return "price-small";
      } else {
        return "price";
      }
    }
  }
</script>
